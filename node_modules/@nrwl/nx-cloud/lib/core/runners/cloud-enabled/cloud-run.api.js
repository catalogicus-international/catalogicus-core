const a3_0x90b6=['devDependencies','axiosException','message','then','recordMetric','status','RunEnd\x20duration','data','value','startRun','throw','unknown','nxCloudVersion','assign','defineProperty','Nx\x20Cloud:\x20Unknown\x20Error\x20Occurred','apply','messages','package.json','RunStart\x20duration','axiosMultipleTries','stringify','post','api','terminalOutput','apiError','defaults','success','string','../../../utilities/metric-logger','getRunGroup','endRun','mapRespToPerfEntry','../../../utilities/axios','stack','next','Run\x20completion\x20responded\x20with\x20`undefined`.','gzip','apiAxiosInstance','...','createReqBody','from','CloudRunApi','RUNNER_FAILURE_PERF_ENTRY','__awaiter','Invalid\x20end\x20run\x20response','createApiAxiosInstance','../../../utilities/nx-imports','@nrwl/nx-cloud','slice','response','/nx-cloud/runs/start','runUrl','RunEnd.\x20Completed\x20tasks','Stack\x20Trace:','note','zlib','parse','length','map','Run\x20Details:','Invalid\x20end\x20run\x20response:\x20','application/octet-stream','/nx-cloud/runs/end','urls','runContext','Invalid\x20Nx\x20Cloud\x20response:\x20','createMetricRecorder','machineInfo','util','VERBOSE_LOGGING','headers','error'];(function(_0x5ebd3c,_0x90b683){const _0x4266f8=function(_0x2c5836){while(--_0x2c5836){_0x5ebd3c['push'](_0x5ebd3c['shift']());}};_0x4266f8(++_0x90b683);}(a3_0x90b6,0x1f2));const a3_0x4266=function(_0x5ebd3c,_0x90b683){_0x5ebd3c=_0x5ebd3c-0x0;let _0x4266f8=a3_0x90b6[_0x5ebd3c];return _0x4266f8;};'use strict';var __awaiter=this&&this[a3_0x4266('0x39')]||function(_0xbb0b9,_0x2beaf6,_0x27c278,_0x5ec4af){function _0x2d7c5e(_0x1947f1){return _0x1947f1 instanceof _0x27c278?_0x1947f1:new _0x27c278(function(_0x56d7c6){_0x56d7c6(_0x1947f1);});}return new(_0x27c278||(_0x27c278=Promise))(function(_0x30f71e,_0x113088){function _0xe392e1(_0x2c36ef){try{_0xe2d5d5(_0x5ec4af[a3_0x4266('0x30')](_0x2c36ef));}catch(_0x2e1b61){_0x113088(_0x2e1b61);}}function _0x61c7ba(_0x2f5bc2){try{_0xe2d5d5(_0x5ec4af[a3_0x4266('0x17')](_0x2f5bc2));}catch(_0x4f39d8){_0x113088(_0x4f39d8);}}function _0xe2d5d5(_0x2b3eb6){_0x2b3eb6['done']?_0x30f71e(_0x2b3eb6[a3_0x4266('0x15')]):_0x2d7c5e(_0x2b3eb6['value'])[a3_0x4266('0x10')](_0xe392e1,_0x61c7ba);}_0xe2d5d5((_0x5ec4af=_0x5ec4af[a3_0x4266('0x1d')](_0xbb0b9,_0x2beaf6||[]))[a3_0x4266('0x30')]());});};Object[a3_0x4266('0x1b')](exports,'__esModule',{'value':!![]});exports['CloudRunApi']=void 0x0;const axios_1=require(a3_0x4266('0x2e'));const environment_1=require('../../../utilities/environment');const fs_1=require('fs');const zlib_1=require(a3_0x4266('0x45'));const util_1=require(a3_0x4266('0x9'));const metric_logger_1=require(a3_0x4266('0x2a'));const {output}=require(a3_0x4266('0x3c'));class CloudRunApi{constructor(_0xcdee2d,_0x289dd4,_0x2d2ce4,_0x1b9a20){this[a3_0x4266('0x1e')]=_0xcdee2d;this[a3_0x4266('0x5')]=_0x289dd4;this[a3_0x4266('0x8')]=_0x1b9a20;this[a3_0x4266('0x33')]=(0x0,axios_1[a3_0x4266('0x3b')])(_0x2d2ce4);}[a3_0x4266('0x16')](_0x1b0de6,_0x4f5142){var _0x2479d9;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x15d08b=(0x0,metric_logger_1[a3_0x4266('0x7')])(a3_0x4266('0x16'));try{const _0x2c71a6={'meta':{'nxCloudVersion':this[a3_0x4266('0x19')]()},'branch':(0x0,environment_1['getBranch'])(),'runGroup':(0x0,environment_1[a3_0x4266('0x2b')])(),'distributedExecutionId':_0x1b0de6,'hashes':_0x4f5142};if(environment_1['VERBOSE_LOGGING']){output['note']({'title':'RunStart','bodyLines':['\x0a'+JSON[a3_0x4266('0x22')](_0x2c71a6,null,0x2)]});}const _0x1b21e6=yield(0x0,axios_1['printDuration'])(a3_0x4266('0x20'),()=>(0x0,axios_1[a3_0x4266('0x21')])(()=>this[a3_0x4266('0x33')][a3_0x4266('0x23')](a3_0x4266('0x40'),_0x2c71a6)));_0x15d08b[a3_0x4266('0x11')]((0x0,metric_logger_1[a3_0x4266('0x2d')])(_0x1b21e6));if(_0x1b21e6[a3_0x4266('0x14')]&&_0x1b21e6[a3_0x4266('0x14')][a3_0x4266('0xf')]){this['messages'][a3_0x4266('0xf')]=_0x1b21e6[a3_0x4266('0x14')][a3_0x4266('0xf')];}if(!_0x1b21e6['data']||!_0x1b21e6[a3_0x4266('0x14')][a3_0x4266('0x4')]){this[a3_0x4266('0x1e')][a3_0x4266('0x26')]=a3_0x4266('0x6')+JSON[a3_0x4266('0x22')](_0x1b21e6['data']);return{};}return _0x1b21e6[a3_0x4266('0x14')]['urls'];}catch(_0x29ca08){_0x15d08b[a3_0x4266('0x11')](((_0x2479d9=_0x29ca08===null||_0x29ca08===void 0x0?void 0x0:_0x29ca08['axiosException'])===null||_0x2479d9===void 0x0?void 0x0:_0x2479d9[a3_0x4266('0x3f')])?(0x0,metric_logger_1[a3_0x4266('0x2d')])(_0x29ca08[a3_0x4266('0xe')]['response']):metric_logger_1[a3_0x4266('0x38')]);this[a3_0x4266('0x1e')][a3_0x4266('0x26')]=this[a3_0x4266('0x1e')]['extractErrorMessage'](_0x29ca08,a3_0x4266('0x24'));return{};}});}[a3_0x4266('0x35')](_0x1b9218,_0x5ef53b,_0x2dcb2e){const _0x5c5589={'meta':{'nxCloudVersion':this[a3_0x4266('0x19')]()},'tasks':_0x5ef53b,'run':_0x1b9218,'linkId':_0x2dcb2e,'machineInfo':this[a3_0x4266('0x8')]};return JSON[a3_0x4266('0x22')](_0x5c5589);}[a3_0x4266('0x2c')](_0xecded2,_0x4af0cf,_0x28dd4d){var _0x44ee79,_0x6c7fd6;return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a3_0x4266('0x1e')][a3_0x4266('0x26')])return![];let _0x4e8228=this[a3_0x4266('0x35')](_0xecded2,_0x4af0cf,_0x28dd4d);if(_0x4e8228[a3_0x4266('0x47')]>0x14*0x3e8*0x3e8){_0x4e8228=this['createReqBody'](_0xecded2,_0x4af0cf['map'](_0x1c3d6b=>Object[a3_0x4266('0x1a')](Object[a3_0x4266('0x1a')]({},_0x1c3d6b),{'hashDetails':undefined})));}const _0x1e3a1c=Buffer[a3_0x4266('0x36')](_0x4e8228);const _0x3640cc=yield(0x0,util_1['promisify'])(zlib_1[a3_0x4266('0x32')])(_0x1e3a1c);const _0x2b371f=(0x0,metric_logger_1[a3_0x4266('0x7')])(a3_0x4266('0x2c'));try{if(environment_1[a3_0x4266('0xa')]){const _0x563a8c=_0x4af0cf[a3_0x4266('0x48')](_0x16bb70=>{return Object[a3_0x4266('0x1a')](Object[a3_0x4266('0x1a')]({},_0x16bb70),{'terminalOutput':_0x16bb70[a3_0x4266('0x25')]?_0x16bb70['terminalOutput'][a3_0x4266('0x3e')](0x0,0x14)+a3_0x4266('0x34'):undefined});});output['note']({'title':a3_0x4266('0x42'),'bodyLines':['\x0a'+JSON[a3_0x4266('0x22')](_0x563a8c,null,0x2)]});}const _0x2bb891=yield(0x0,axios_1['printDuration'])(a3_0x4266('0x13'),()=>(0x0,axios_1[a3_0x4266('0x21')])(()=>this['apiAxiosInstance'][a3_0x4266('0x23')](a3_0x4266('0x3'),_0x3640cc,{'headers':Object[a3_0x4266('0x1a')](Object[a3_0x4266('0x1a')]({},this[a3_0x4266('0x33')][a3_0x4266('0x27')][a3_0x4266('0xb')]),{'Content-Encoding':a3_0x4266('0x32'),'Content-Type':a3_0x4266('0x2')})})));if(_0x2bb891){_0x2b371f['recordMetric']((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x2bb891));if(_0x2bb891[a3_0x4266('0x14')]&&_0x2bb891['data'][a3_0x4266('0x41')]&&_0x2bb891[a3_0x4266('0x14')]['status']===a3_0x4266('0x28')){this[a3_0x4266('0x5')][a3_0x4266('0x41')]=_0x2bb891['data'][a3_0x4266('0x41')];return!![];}if(_0x2bb891[a3_0x4266('0x14')]&&_0x2bb891[a3_0x4266('0x14')][a3_0x4266('0x12')]){this[a3_0x4266('0x1e')][a3_0x4266('0x26')]=a3_0x4266('0x1')+JSON[a3_0x4266('0x22')](_0x2bb891[a3_0x4266('0x14')]['message']);}else if(_0x2bb891[a3_0x4266('0x14')]&&typeof _0x2bb891['data']===a3_0x4266('0x29')){if(_0x2bb891['data']!==a3_0x4266('0x28')){this[a3_0x4266('0x1e')][a3_0x4266('0x26')]=a3_0x4266('0x1')+JSON[a3_0x4266('0x22')](_0x2bb891[a3_0x4266('0x14')]);}}else{this[a3_0x4266('0x1e')][a3_0x4266('0x26')]='Invalid\x20end\x20run\x20response:\x20'+JSON[a3_0x4266('0x22')](_0x2bb891[a3_0x4266('0x14')]);}if(environment_1['VERBOSE_LOGGING']){output[a3_0x4266('0x44')]({'title':a3_0x4266('0x3a'),'bodyLines':[JSON[a3_0x4266('0x22')](_0x2bb891[a3_0x4266('0x14')],null,0x2)]});}}else{output[a3_0x4266('0xc')]({'title':a3_0x4266('0x1c'),'bodyLines':[a3_0x4266('0x31'),a3_0x4266('0x0'),JSON[a3_0x4266('0x22')](_0xecded2,null,0x2),a3_0x4266('0x43'),JSON[a3_0x4266('0x22')](new Error()[a3_0x4266('0x2f')],null,0x2)]});}return![];}catch(_0x5361ae){_0x2b371f[a3_0x4266('0x11')](((_0x44ee79=_0x5361ae===null||_0x5361ae===void 0x0?void 0x0:_0x5361ae[a3_0x4266('0xe')])===null||_0x44ee79===void 0x0?void 0x0:_0x44ee79[a3_0x4266('0x3f')])?(0x0,metric_logger_1[a3_0x4266('0x2d')])(_0x5361ae[a3_0x4266('0xe')][a3_0x4266('0x3f')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);const _0x2bb394=(_0x6c7fd6=_0x5361ae[a3_0x4266('0xe')])!==null&&_0x6c7fd6!==void 0x0?_0x6c7fd6:_0x5361ae;this[a3_0x4266('0x1e')][a3_0x4266('0x26')]=this[a3_0x4266('0x1e')]['extractErrorMessage'](_0x2bb394,'api');return![];}});}['nxCloudVersion'](){try{const _0x281461=JSON[a3_0x4266('0x46')]((0x0,fs_1['readFileSync'])(a3_0x4266('0x1f'))['toString']());return _0x281461[a3_0x4266('0xd')][a3_0x4266('0x3d')];}catch(_0x4071b4){return a3_0x4266('0x18');}}}exports[a3_0x4266('0x37')]=CloudRunApi;